<!DOCTYPE html>
<html>
	<head>

		<meta charset="utf-8" />
		<title>Assignment 4</title>

	</head>
	<body>
	<h1>Assignment 4</h1>
	<p>By Sam Hollingsworth</p>

	<h2>Introduction</h2>
		<p>thawing-hamlet-47380 is a Web Application implemented as a web server to keep records of all checkins
			from all users and return data when the correct information is provided. The server also contains
			information of all monuments on the East Coast and provides users with monumnets within a mile of
			their location when prompted. The Web App uses Node.js + Express and
			a database to store all the information through mongoDB. I was hired to find the security and
			privacy issues in the web application and record them in this document with my recommendations
			to resolve each issue.
		</p>

	<h2>Methodology</h2>
		<p>I began my testing with the attacks recommended in class by Ming. First, a Cross-Site Scripting attack
			then a mongoDB injection. Next, I looked at the source code of the application and found bad
			programming practices implemented by the developer so I documented how it can affect the application
			and by those who use it.
		</p>

	<h2>Abstract of Findings</h2>
		<p>This web application contains security and privacy issues that range from Low to High Severity. All the
			issues come from the application trusting the data the user inputs. This is bad practice and should
			not exist in web applications as user input should never be trusted. All the issues found can be
			resolved by implementing checks to make sure the input is what the developer intended in order to
			filter out any malicious input to damage the application or gain access to confidential information.
		</p>

	<h2>Issues Found</h2>
	<ol>
		<li>
			<p>Issue: Cross-Site Scripting</p>
			<p>Location: XSS result can be found at https://thawing-hamlet-47380.herokuapp.com</p>
			<p>Severity: Medium since a user can affect the experience of another</p>
			<p>Description: When data is sent to the app in the fields login, latitude, and
				longitude the app does not remove special characters before inserting into the database.
				So when the checkins are listed on the homepage, the script written by the user is
				executed and results in an alert.
				<img id="XSScurl" src="XSScurl.png" alt="Picture of curl command"/></p>
			<p>Proof of Vulnerability:
				<img id="XSSalert" src="XSSalert.png" alt="Picture of alert"/></p>
			<p>Resolution: Remove special characters from data before inserting into database</p>
		</li>

		<li>
			<p>Issue: mongoDB Injection</p>
			<p>Location: https://thawing-hamlet-47380.herokuapp.com/checkins.json</p>
			<p>Severity: High because someone can view all the checkins of everyone that has checked in,
				allowing them to see every location the other users have been</p>
			<p>Description: Using the mongoDB injection,
				https://thawing-hamlet-47380.herokuapp.com/checkins.json?login[$ne]="Sam", allows
				someone to access all the checkins for the other users since $ne means not equal
				and will find all the usernames not equal to "Sam". In addition, upon looking at the
				source code, my partner does not use the login to find specific users in the database.
				Anything added to the end of /checkins.json? will result in all user information being
				displayed.</p>
			<p>Proof of Vulnerability:
				<img id="mongoDBi" src="mongoDBi.png" alt="Picture of mongoDBi"/></p>
			<p>Resolution: Install something like Sqreen in the Node.js app to prevent from mongoDB injections
				that does data validation on user input. Also, use the login to find specific users in the
				database instead of returning all users every time.</p>
		</li>

		<li>
			<p>Issue: Bad Programming Practices</p>
			<p>Location: Within the method of the route
				https://thawing-hamlet-47380.herokuapp.com/sendLocation</p>
			<p>Severity: Low because incorrect data won't affect other users</p>
			<p>Description: Data sent to the server in the fields login, latitude, and longitude is only
				checked if it is undefined. This allows the user to send anything to be stored in the
				database and not what it is intended by the developer. This can cause problems for
				applications that use the web server and rely on correct data from the server.</p>
			<p>Proof of Vulnerability:
				<img id="badcoding" src="badcoding.png" alt="Picture of Bad Programming"/></p>
			<p>Resolution: Add more checks to make sure the login is a string, the latitude and longitude are
				a float.</p>
		</li>

	</ol>

	<h2>Conclusion</h2>
		<p>In conclusion, there were 3 issues found so far; a Cross-Site Scripting vulnerability, a mongoDB injection
			vulnerability, and bad programming practices. This was not a comprehensive review of all security
			flaws in the application, just the first 3 that were noticed by me. There are more present. In the
			future, all data should be filtered in order to ensure it can be trusted and it won't hurt the
			application.
		</p>

	<h2>References</h2>
		<ul>
			<li>
				<a href="https://blog.sqreen.io/prevent-nosql-injections-mongodb-node-js/">"How to prevent
				NoSQL injections in MongoDB in a Node.js app" blog post</a>
			</li>
		</ul>

</body>
</html>
